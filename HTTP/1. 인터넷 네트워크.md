# 인터넷 네트워크

- 인터넷을 통해서 클라이언트와 서버는 원거리에 있어도 통신을 할 수 있음.
- 하지만 인터넷망은 복잡하다.
  - 해저 광케이블, 인공위성 등등..
  - 수 많은 중간 노드라고 하는 서버를 거쳐서 안전하게 메세지를 전달해야한다.
- 어떻게 복잡한 망을 이용해 클라이언트와 서버가 통신을 할 수 있을까?

---

## IP (Internet Protocol)

복잡한 인터넷망에는 `최소한의 규칙`이 필요하다.  
`IP주소를 부여하자!`

### IP의 역할
- 지정한 IP 주소(IP Address)에 데이터 전달
- 패킷(Packet)이라는 통신 단위로 데이터를 전달한다.
- 클라이언트 패킷 전달
  - 클라이언트가 보내는 패킷에는 출발지IP, 목적지IP, 기타..가 담겨져 있다.
  - 정보가 담겨있는 패킷을 인터넷망으로 더진다.
  - 규약에 따라 노드 간에 패킷을 던지면서 최종적으로는 목적지(서버)에 도달한다.
- 서버 패킷 전달
  - 서버 패킷도 클라이언트 패킷이 거쳤던 과정을 통해서 클라이언트에게 메세지를 전달한다.

### IP의 한계
- 비연결성
  - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷을 전송한다.
    - 클라이언트는 대상 서버가 패킷을 받을 수 있는 상태인지 아닌지 모른다. 
- 비신뢰성
  - 패킷 소실
    - 중간에 패킷이 사라진다면?
  - 패킷 전달 순서 문제 발생
    - 패킷이 순서대로 안온다면?
- 프로그램 구분
  - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘이상이라면?

---
## TCP,UDP
IP의 한계를 TCP가 해결해준다!

### 인터넷 프로토콜 스택의 4계층
- 애플리케이션 계층 - HTTP, FTP
- 전송 계층(OS) - TCP, UDP 
- 인터넷 계층(OS) - IP 
- 네트워크 인터페이스 계층 - LAN 드라이버, LAN 장비

채팅 프로그램으로 Hello, world! 라는 메세지를 전송한다고 가정해보자.
1. 프로그램이 Hello, world! 메세지 작성
2. SOCKET 라이브러리를 통해 OS 계층에 전달
3. TCP 정보를 생성해서 씌운다. 메세지 데이터 포함
4. IP 패킷을 생성해서 씌운다. TCP 데이터 포함
5. 이후 랜카드를 통해서 정보가 나간다.

### TCP/IP 패킷 정보
- IP 패킷
  - 출발지IP, 목적지IP, 기타...
- TCP/IP 패킷
  - 출발지 PORT, 목적지 PORT, 전송 제어, 순서, 검증정보...
  - IP만으로 해결이 안되었던 문제들이 해결된다!

### TCP 특징
전송 제어 프로토콜 (Transmission Control Protocol)  
TCP는 IP 바로 윗계층에 있는 프로토콜이다. 

- 연결 지향
  - TCP 3 way handshake
  - SYN : 접속 요청
  - ACK : 요청 수락
    - 1. SYN
    - 2. SYS+ACK
    - 3. ACK
  - 만약에 서버가 꺼져있고, 클라이언트가 접속을 하려고 한다면, 클라이언트가 SYN 메세지를 보냈을 때 응답이 오지않는다.
  - 응답이 없으면 클라이언트가 메세지를 보내지 않는다.
- 데이터 전달 보증
  - 클라이언트가 데이터 전송시, 서버에서 데이터를 잘받았다고 메세지를 보낸다.
- 순서 보장
  - 클라이언트에서 패킷1, 패킷2, 패킷3 순서로 전송
  - 서버에 패킷1, 패킷3, 패킷2 순서로 도착
  - 서버에서 패킷2부터 다시 보내라고 요청한다.
- 신뢰할 수 있는 프로토콜
- 현재는 대부분 TCP 사용

### UDP
사용자 데이터그램 프로토콜 (User Datagram Protocol)

- 하얀 도화지에 비유(기능이 거의 없음)
- 연결 지향 - TCP 3 way handshake X
- 데이터 전달 보증 X
- 순서 보장 X
- 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠르다.
- 정리
  - IP와 거의 같다. + PORT + 체크섬 정도만 추가
  - 애플리케이션에서 추가 작업 필요

---

## PORT

- 내(클라이언트)가 게임, 화상통화, 웹브라우저 요청을 동시에 하고 있다면?
- 클라이언트 PC가 여러개의 서버와 통신해야한다.  
- 보내는 패킷이나 받는 패킷이나 어느 서버에서 오는지 가는지 구분해야한다.
  - TCP/IP 패킷에 출발지 `PORT`, 목적지 `PORT`로 구분한다.

> PORT : 같은 IP 내에서 프로세스를 구분

IP는 아파트이고, PORT는 동, 호수라고 비유
- 0 ~ 65535 할당 가능
- 0 ~ 1023 : 잘 알려진 포트, 사용하지 않는 것이 좋다.
  - FTP - 20,21
  - TELNET - 23
  - HTTP - 80
  - HTTPS - 443

---

## DNS (Domain Name System)

IP는 기억하기 어렵다.  
IP는 변경될 수 있다.  
-> DNS 사용
- 도메인 명을 IP 주소로 변환한다.